<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tf_1.8_xla_doc: tensorflow::XlaCompiler Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tf_1.8_xla_doc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../de/d86/namespacetensorflow.html">tensorflow</a></li><li class="navelem"><a class="el" href="../../d7/dbf/classtensorflow_1_1XlaCompiler.html">XlaCompiler</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="../../d6/d27/classtensorflow_1_1XlaCompiler-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">tensorflow::XlaCompiler Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../db/d88/xla__compiler_8h_source.html">xla_compiler.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ade5be3e41d2892412acb844070182858"><td class="memItemLeft" align="right" valign="top">Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dbf/classtensorflow_1_1XlaCompiler.html#ade5be3e41d2892412acb844070182858">CompileGraph</a> (const CompileOptions &amp;options, string const &amp;name, std::unique_ptr&lt; Graph &gt; graph, const std::vector&lt; Argument &gt; &amp;args, CompilationResult *result)</td></tr>
<tr class="memdesc:ade5be3e41d2892412acb844070182858"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compiles a tensorflow::Graph into an xla::Computation.  <a href="#ade5be3e41d2892412acb844070182858">More...</a><br /></td></tr>
<tr class="separator:ade5be3e41d2892412acb844070182858"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:af976233791194ab48c2512fdfac123ea"><td class="memItemLeft" align="right" valign="top">Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dbf/classtensorflow_1_1XlaCompiler.html#af976233791194ab48c2512fdfac123ea">BuildArguments</a> (const Graph &amp;graph, const std::vector&lt; XlaCompiler::Argument &gt; &amp;args, bool use_tuple_arg, <a class="el" href="../../df/d1b/classxla_1_1ComputationBuilder.html">xla::ComputationBuilder</a> *builder, XlaContext *context, std::vector&lt; int &gt; *arg_cores, std::vector&lt; XlaExpression &gt; *arg_expressions, std::vector&lt; int &gt; *input_mapping, std::vector&lt; xla::Shape &gt; *input_shapes, bool is_entry_computation)</td></tr>
<tr class="memdesc:af976233791194ab48c2512fdfac123ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build XLA computations for each of the arguments to the <code>UserComputation</code>.  <a href="#af976233791194ab48c2512fdfac123ea">More...</a><br /></td></tr>
<tr class="separator:af976233791194ab48c2512fdfac123ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><blockquote class="doxtable">
<p>The <a class="el" href="../../d7/dbf/classtensorflow_1_1XlaCompiler.html">XlaCompiler</a> class is responsible for compilation of a self-contained subgraph of a TensorFlow computation using the XLA linear algebra runtime. It does a symbolic execution of the graph starting from specific input shapes, using a JIT device to convert operators into XLA computations.</p>
<p><a class="el" href="../../d7/dbf/classtensorflow_1_1XlaCompiler.html">XlaCompiler</a> is typically invoked from an <code>_XlaLaunch</code> operator once the shapes of all input parameters to the computation are known. This is because the symbolic execution requires known shapes for all operations.</p>
<p><a class="el" href="../../d7/dbf/classtensorflow_1_1XlaCompiler.html">XlaCompiler</a> compiles Tensorflow graphs that received inputs via _Arg nodes, and return outputs via _Retval nodes.</p>
<p>The <a class="el" href="../../d7/dbf/classtensorflow_1_1XlaCompiler.html">XlaCompiler</a> requires one Argument struct for each _Arg index, that describes each argument. Arguments can be compile-time constants (kind kConstant), run-time parameters (kind kParameter), or resources (kind kResource).</p>
<p>Only kParameter and initialized kResource arguments become runtime parameters to the generated XLA computation. The XLA computation will have run-time parameters in the following order: +------------------&mdash;+--------------------------------------&mdash;+ | kParameter values | Initial values of kResource arguments | +------------------&mdash;+--------------------------------------&mdash;+ Within each block, the arguments are arranged by the _Arg index from which they were derived.</p>
<p>The run-time outputs of the XLA computation are arranged in the following order: +---------------&mdash;+--------------------------------------&mdash;+ | _Retval values | Updated values of kResource arguments | +---------------&mdash;+--------------------------------------&mdash;+ _Retval values are ordered by _Retval index, whereas kResource values are ordered by the original _Arg position of the variable.</p>
<p>In both inputs and outputs, kResource values are placed the end. When emitting While loop bodies, we must ensure that the loop body has identical input and output signatures. By moving variable values to the end of the argument list and using the <code>return_updated_values_for_all_variables</code> option, we can ensure that the input and output values of resources appear at the same positions.</p>
<p>Resources are passed as parameters or returned as resource updates in "packed" form. kStack resources are packed as (array, size of stack) XLA tuples. kTensorArray resources without gradients are packed as the array that backs the TensorArray. If gradients are present (<code>tensor_array_gradients</code>), the packed representation is a (array, gradient0, gradient1, ...) tuple, where gradient_k is the value of the k-th gradient in the <code>tensor_array_gradients</code> ordered set.</p>
</blockquote>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="af976233791194ab48c2512fdfac123ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af976233791194ab48c2512fdfac123ea">&#9670;&nbsp;</a></span>BuildArguments()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Status tensorflow::XlaCompiler::BuildArguments </td>
          <td>(</td>
          <td class="paramtype">const Graph &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; XlaCompiler::Argument &gt; &amp;&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_tuple_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d1b/classxla_1_1ComputationBuilder.html">xla::ComputationBuilder</a> *&#160;</td>
          <td class="paramname"><em>builder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">XlaContext *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>arg_cores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; XlaExpression &gt; *&#160;</td>
          <td class="paramname"><em>arg_expressions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>input_mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; xla::Shape &gt; *&#160;</td>
          <td class="paramname"><em>input_shapes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_entry_computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build XLA computations for each of the arguments to the <code>UserComputation</code>. </p>
<ol type="1">
<li>Traverse <code>args</code> (arguments to the <code>UserComputation</code>) to set index of non-constant arguments in <code>input_mapping</code> (in order of <code>kParameter</code> to <code>kResource</code>).</li>
<li>Traverse <code>input_mapping</code> to compute the shapes of non-constant arguments and record in <code>arg_shapes</code>. Based on the option <code>use_tuple_arg</code>, it decides how to store <code>arg_shapes</code> to <code>input_shapes</code>.</li>
<li>Use <code>_Arg</code> nodes in graph to resolve core assignments. The result is written in function argument <code>arg_cores</code>.</li>
<li>Build parameter handles for non-constant arguments.</li>
<li>[TODO] Fill in the handles in non-constant arguments.</li>
</ol>
<p>Unclear parts:</p><ol type="1">
<li>Usage of <code>XlaResource</code> in 1.</li>
<li>Order of <code>kParameter</code> &amp; <code>kResource</code> in 1.</li>
<li>Will <code>input_shapes</code> be used in the future? in 2.</li>
<li>What's sharding for? The detail of retrieving sharding info. in 3. </li>
</ol>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dbf/classtensorflow_1_1XlaCompiler_af976233791194ab48c2512fdfac123ea_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dbf/classtensorflow_1_1XlaCompiler_af976233791194ab48c2512fdfac123ea_icgraph.svg" width="383" height="50"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ade5be3e41d2892412acb844070182858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade5be3e41d2892412acb844070182858">&#9670;&nbsp;</a></span>CompileGraph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Status tensorflow::XlaCompiler::CompileGraph </td>
          <td>(</td>
          <td class="paramtype">const CompileOptions &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string const &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; Graph &gt;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Argument &gt; &amp;&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CompilationResult *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compiles a tensorflow::Graph into an xla::Computation. </p>
<ol type="1">
<li>Check status of initialization (set during construction).</li>
<li>Functionalize control flow in Graph in order to be compiled into XLA code.</li>
<li>Contruct <code>ComputationBuilder</code> &amp; <code>XlaContext</code> objects.</li>
<li>Build argument (Build XLA computations for each of arguments to the <code>UserComputation</code>.)</li>
<li>[TODO] </li>
</ol>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dbf/classtensorflow_1_1XlaCompiler_ade5be3e41d2892412acb844070182858_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>tensorflow/tensorflow/compiler/tf2xla/<a class="el" href="../../db/d88/xla__compiler_8h_source.html">xla_compiler.h</a></li>
<li>tensorflow/tensorflow/compiler/tf2xla/<a class="el" href="../../d5/d88/xla__compiler_8cc.html">xla_compiler.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
